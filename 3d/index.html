<html>
  <head>
    <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
    <script src="https://unpkg.com/aframe-environment-component@1.2.0/dist/aframe-environment-component.min.js"></script>
    <script src="js/aframe/components/canvas-updater.js"></script>
    <script src = "https://cdn.jsdelivr.net/npm/webmidi"></script>

    <link href="css/squeakjs.css"
	  rel="stylesheet" />
    
    <link rel="manifest"
	  href="manifest.json">

    <body>
      <script type="text/javascript" src="/js/hex.js"></script>
      <script src="js/aframe/components/mousemove.js"></script>
      <script src="https://unpkg.com/aframe-teleport-controls/dist/aframe-teleport-controls.min.js"></script>
      
      <a-scene id="scene"

	       raycaster="showLine: false;
			  far: 100;
			  objects: .squeaky"

	       line="color: orange;
		     opacity: 0.5"

	       cursor="rayOrigin: mouse"
	       keyboard-shortcuts="enterVR: false">

	<a-assets>

	  <canvas id="caffeine-canvas"
		  width="1440"
		  height="900"
		  tabindex="1"
		  crossorigin="anonymous"
		  appID="d93ea2a2-bf59-4f59-bb21-c36c596c4488"

		  style="cursor: default;
			 opacity: 1;
			 transition: opacity 500ms"></canvas>

	  <img id="logo"
	       src="pictures/backgrounds/bootscreen/bootscreen1024x512.jpeg">

	</a-assets>
	
	<a-entity class="squeaky"
		  id="squeak-plane"

		  material="shader: flat;
			    transparent: true;
			    opacity: 0.8;
			    src: #caffeine-canvas"

                  geometry="primitive: plane;
			    width: 14;
			    height: 8.7"

                  position="0 10 -8"
		  mousemove
		  canvas-updater></a-entity>

	<a-box id="squeak-frame-top"
	       position="0 14.60 -7.9"
	       width="15"
	       height="0.25"
	       depth="0.25"
	       color="gray"></a-box>

	<a-box id="squeak-frame-bottom"
	       position="0 5.40 -7.9"
	       width="15"
	       height="0.25"
	       depth="0.25"
	       color="gray"></a-box>

	<a-box id="squeak-frame-left"
	       position="-7.25 10 -7.9"
	       width="0.25"
	       height="9.7"
	       depth="0.25"
	       color="gray"></a-box>

	<a-box id="squeak-frame-right"
	       position="7.25 10 -7.9"
	       width="0.25"
	       height="9.7"
	       depth="0.25"
	       color="gray"></a-box>

	<div id="progress-spinner"
	     style="opacity: 0.8;
		    z-index: 10;
		    margin: inherit;
		    top: 18;
		    left: inherit;
		    right: 19;
		    bottom: inherit;
		    width: 52px;
		    height: 52px;">

	  <!-- no "spokes" div, so the spinner just glows -->
	  
	  <div id="sqSpinnerSpokes"

	       style="top: 21px;
                      width: 42px;"></div></div>

	<a-entity environment="preset: forest"></a-entity>

	<a-plane id="logo"
		 src="#logo"
		 width="14"
		 height="8.7"
		 position="0 10 -8.1"
		 rotation="0 180 0"></a-plane>

	<a-entity id="wind"
		  position="0 10 -8"

		  sound="src: #wind-sound;
			 loop: true"></a-entity>
	
	
	<a-entity id="cameraRig"
		  position="0 10 0"
		  rotation>

	  <a-entity id="left-hand"
		    laser-controls="hand: left"
		    hand-controls="hand: left"

		    raycaster="objects: .squeaky;
			       far: 1000"

		    line="color: red; 
			  opacity: 0.75"
		    
		    teleport-controls="cameraRig: #cameraRig; 
				       button: grip;
				       hitCylinderColor: #ff3468; 
				       curveHitColor: #ff3468; 
				       curveMissColor: #333333; 
				       curveLineWidth: 0.01"
		    
		    brush
		    ui></a-entity>

	  <a-entity id="right-hand"
		    laser-controls="hand: right"
		    hand-controls="hand: right"

		    raycaster="objects: .squeaky;
			       far: 1000"

		    line="color: red; 
			  opacity: 0.75"
		    
		    brush
		    ui></a-entity>

	  <a-entity id="camera"
		    position="0 10 50"

		    camera
		    look-controls
		    wasd-controls></a-entity></a-entity>

	<input id="home"
	       type="image"
	       src="pictures/icons/a-frame/home.png"
	       tabindex="-1"
	       width="70"
	       height="70"
	       style="opacity: 0.5;
		      user-select: none;
		      outline: none;
		      z-index: 10;
		      position: absolute;
		      right: 10;
		      top: 10"></a-scene>
      
      <!--
	  <script>
	    document.getElementById('squeak-plane').addEventListener('raycaster-intersected', (event) => {
	    console.log('squeak plane hit')})
	  </script>
	  -->

	  <script src="js/squeakjs/squeak.js"></script>
	  <script src="js/startup.js"></script>
	  <script src="js/oscrelay/node_modules/osc/dist/osc-browser.min.js"></script>
	  <script src="js/aframe/mobileUtilities.js"></script>
	  <script>
	    setTimeout(() => {[].slice.call(document.getElementsByClassName('environment')).forEach(each => {
	      if (each.components['light']) {each.components['light'].light.intensity = 0}})}, 2000)
	  </script></body></html>
